-- This SQL script focuses on extracting meaningful insights from a database containing customer and order data. 
-- By querying multiple tables, I aim to quantify various statistics that shed light on the purchasing patterns and preferences of customers. 
-- The following set of queries delves into key aspects such as order quantities, product-specific details, and revenue calculations for specified time frames and locations.
 

-- 1. Count the number of orders placed in January
SELECT COUNT(orderID) 
FROM BIT_DB.JanSales
WHERE LENGTH(orderID) = 6
  AND orderID <> 'Order ID';

-- 2. Count the number of orders for iPhones placed in January
SELECT COUNT(orderid)
FROM BIT_DB.JanSales
WHERE Product = 'iPhone'
  AND LENGTH(orderid) = 6
  AND orderid <> 'Order ID';

-- 3. Retrieve customer account numbers for all orders placed in February
SELECT cust.account_number
FROM BIT_DB.customers cust
INNER JOIN BIT_DB.FebSales feb ON cust.order_ID = feb.orderID
WHERE LENGTH(feb.orderid) = 6
  AND feb.orderid <> 'Order ID';

-- 4. Identify the cheapest product sold in January and its price
SELECT DISTINCT product, price
FROM BIT_DB.JanSales
WHERE price = (SELECT MIN(price) FROM BIT_DB.JanSales)
GROUP BY product;

-- 5. Calculate total revenue for each product sold in January
SELECT product, ROUND(SUM(quantity * price), 1) as Revenue
FROM BIT_DB.JanSales
GROUP BY product;

-- 6. Determine products sold in February at a specific location, along with quantity and total revenue
SELECT SUM(quantity) as total_quantity, product, SUM(quantity * price) as total_revenue
FROM BIT_DB.FebSales
WHERE location = '548 Lincoln St, Seattle, WA 98101'
GROUP BY product;

-- 7. Identify customers who ordered more than 2 products and calculate their average spending
SELECT COUNT(DISTINCT acctnum) as customer_count, AVG(quantity * price) as average_spending
FROM BIT_DB.FebSales feb
LEFT JOIN BIT_DB.customers cust ON feb.orderID = cust.order_id
WHERE feb.quantity > 2
  AND LENGTH(orderid) = 6
  AND orderid <> 'Order ID';

-- 8. Extract a list of distinct products sold in Los Angeles in February providing the total quantity of each product sold in that location during the specified period
SELECT distinct Product, sum(quantity)
FROM BIT_DB.FebSales
WHERE location LIKE '%Los Angeles%'
GROUP BY Product
